<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Efemérides Geek</title>
    <style>
        /* TODO TU CSS ACTUAL (sin cambios) */
        :root {
            --primary-color: #001f3f;
            --secondary-color: #003366;
            --accent-color: #ffc300;
            --text-color: #f7f7f7;
        }
        /* ... todo tu CSS completo ... */
    </style>
</head>
<body>
    <div class="app-container">
        <div id="event-container" class="content-main"></div>
    </div>

    <script>
        // VARIABLES GLOBALES
        let events = [];
        let defaultImage = "https://images.unsplash.com/photo-1550745165-9bc0b252726f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80";
        let defaultlicense = "Imagen por defecto de Unsplash";
        const ROTATION_TIME_MS = 10000;

        const container = document.getElementById('event-container');
        let currentIndex = 0;
        let rotationInterval;

        // CARGAR DATOS DESDE JSON
        async function loadData() {
            try {
                const response = await fetch('./data/events.json');
                const data = await response.json();
                
                events = data.events || [];
                defaultImage = data.defaultImage || defaultImage;
                defaultlicense = data.defaultLicense || defaultlicense;
                
                if (events.length > 0) {
                    displayEvent(events[currentIndex], currentIndex);
                    startRotation();
                    createIndicators();
                } else {
                    showNoEvents();
                }
            } catch (error) {
                console.error('Error loading data:', error);
                showError();
            }
        }

        // FUNCIÓN PARA MOSTRAR EVENTO (tu código adaptado)
        function displayEvent(event, index) {
            const prefix = event.prefix || '';
            const eventTitle = event.evento || '';
            const description = event.descripcion || '';
            const year = event.año || '';
            let sourceAttribution = event.fuenteImagen || '';
            
            // Manejo de imágenes
            let imageSource = event.imagenUrl || defaultImage;
            if (!sourceAttribution && imageSource === defaultImage) {
                sourceAttribution = defaultlicense;
            }

            // Detectar orientación
            const isLandscape = window.matchMedia("(orientation: landscape)").matches;
            const isDesktop = window.innerWidth >= 1025;

            let html = '';

            if (isLandscape || isDesktop) {
                // Layout horizontal
                html = `
                    <div class="layout-horizontal content-main fade-in">
                        <div class="text-content">
                            <h1>${prefix}</h1>
                            <div class="title-emphasis">${eventTitle}</div>
                            <div class="description-col">
                                ${description ? `<p>${description}</p>` : ''}
                                ${year ? `<p class="year">Año: ${year}</p>` : ''}
                            </div>
                        </div>
                        <div class="image-content">
                            <img src="${imageSource}" alt="Imagen de ${eventTitle}" onerror="this.src='${defaultImage}'">
                            ${generateIndicators(index, 'horizontal')}
                            ${sourceAttribution ? `<div class="image-attribution">${sourceAttribution}</div>` : ''}
                        </div>
                    </div>
                `;
            } else {
                // Layout vertical
                html = `
                    <div class="layout-vertical content-main fade-in">
                        <div class="image-vertical">
                            <img src="${imageSource}" alt="Imagen de ${eventTitle}" onerror="this.src='${defaultImage}'">
                            ${sourceAttribution ? `<div class="image-attribution-vertical">${sourceAttribution}</div>` : ''}
                        </div>
                        <div class="text-vertical">
                            <div class="text-vertical-content">
                                <h1>${prefix}</h1>
                                <div class="title-emphasis">${eventTitle}</div>
                                <div class="description-col">
                                    ${description ? `<p>${description}</p>` : ''}
                                    ${year ? `<p class="year">Año: ${year}</p>` : ''}
                                </div>
                            </div>
                        </div>
                        ${generateIndicators(index, 'vertical')}
                    </div>
                `;
            }
            
            container.innerHTML = html;
            attachIndicatorListeners();
        }

        // ... (TODAS TUS OTRAS FUNCIONES: generateIndicators, attachIndicatorListeners, startRotation, etc.)

        // INICIALIZAR
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });

        // Manejar redimensionamiento
        window.addEventListener('resize', function() {
            if (events.length > 0) {
                displayEvent(events[currentIndex], currentIndex);
            }
        });
    </script>
</body>
</html>
